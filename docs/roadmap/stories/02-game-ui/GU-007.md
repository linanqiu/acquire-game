# GU-007: Portfolio Display

## Metadata
- **Epic**: Game UI
- **Status**: `complete`
- **Priority**: `medium`
- **Effort**: `M` (1-2 hours)
- **Dependencies**: GU-005, GU-006

## Context

Detailed stock holdings display showing current value of each chain's stocks. Used in player view to show portfolio value and in game over screen for breakdown.

## Requirements

1. List all owned stocks with quantities
2. Show current price per share
3. Calculate and display total value per chain
4. Show portfolio total
5. Optional: show change animation for value updates

## Acceptance Criteria

- [x] Lists each chain with non-zero holdings
- [x] Shows: chain marker, quantity, price, total value
- [x] Calculates total correctly (quantity × price)
- [x] Shows portfolio total at bottom
- [x] Values formatted with $ and commas
- [x] Tabular number alignment
- [x] Handles empty portfolio gracefully
- [x] Unit tests for calculations

## Implementation Notes

### File to Create

**frontend/src/components/game/Portfolio.tsx**:
```tsx
import { ChainMarker } from './ChainMarker'
import { Card } from '../ui/Card'
import styles from './Portfolio.module.css'
import type { ChainName } from '../../types/game'

interface StockHolding {
  chain: ChainName
  quantity: number
}

interface ChainPrices {
  [key: string]: number  // chain name -> price per share
}

interface PortfolioProps {
  holdings: StockHolding[]
  prices: ChainPrices
  showTotal?: boolean
}

export function Portfolio({ holdings, prices, showTotal = true }: PortfolioProps) {
  const holdingsWithValue = holdings
    .filter((h) => h.quantity > 0)
    .map((h) => ({
      ...h,
      price: prices[h.chain] || 0,
      value: h.quantity * (prices[h.chain] || 0),
    }))

  const total = holdingsWithValue.reduce((sum, h) => sum + h.value, 0)

  if (holdingsWithValue.length === 0) {
    return (
      <Card title="PORTFOLIO">
        <p className={styles.empty}>No stocks owned</p>
      </Card>
    )
  }

  return (
    <Card title="PORTFOLIO">
      <table className={styles.table}>
        <tbody>
          {holdingsWithValue.map((h) => (
            <tr key={h.chain}>
              <td className={styles.chain}>
                <ChainMarker chain={h.chain} variant="compact" />
              </td>
              <td className={styles.quantity}>{h.quantity}</td>
              <td className={styles.times}>×</td>
              <td className={styles.price}>${h.price.toLocaleString()}</td>
              <td className={styles.equals}>=</td>
              <td className={styles.value}>${h.value.toLocaleString()}</td>
            </tr>
          ))}
        </tbody>
        {showTotal && (
          <tfoot>
            <tr className={styles.totalRow}>
              <td colSpan={5} className={styles.totalLabel}>TOTAL VALUE:</td>
              <td className={styles.totalValue}>${total.toLocaleString()}</td>
            </tr>
          </tfoot>
        )}
      </table>
    </Card>
  )
}
```

**frontend/src/components/game/Portfolio.module.css**:
```css
.table {
  width: 100%;
  border-collapse: collapse;
}

.table td {
  padding: var(--space-1) var(--space-2);
  font-variant-numeric: tabular-nums;
}

.chain {
  text-align: left;
}

.quantity, .price, .value {
  text-align: right;
}

.times, .equals {
  text-align: center;
  color: var(--text-secondary);
}

.value {
  color: var(--text-positive);
  font-weight: var(--font-medium);
}

.totalRow {
  border-top: 1px solid var(--border);
}

.totalLabel {
  text-align: right;
  padding-top: var(--space-2);
  color: var(--text-secondary);
}

.totalValue {
  text-align: right;
  padding-top: var(--space-2);
  font-weight: var(--font-bold);
  color: var(--text-positive);
}

.empty {
  color: var(--text-secondary);
  font-style: italic;
  text-align: center;
  padding: var(--space-4);
}
```

### Layout
```
+------------------------------+
| PORTFOLIO                    |
+------------------------------+
| LUX   5 × $800  = $4,000     |
| AME   3 × $600  = $1,800     |
| CON   8 × $1000 = $8,000     |
+------------------------------+
| TOTAL VALUE:       $13,800   |
+------------------------------+
```

## Verification

```bash
npm run test -- --grep "Portfolio"

# Visual with mock data
npm run dev
```

## Reference

- [Components Spec - Portfolio](../../../ui/components.md#portfolio)
