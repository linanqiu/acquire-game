<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acquire - Player View</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="player-container">
        <header class="player-header">
            <div class="player-info">
                <h1 class="player-name" id="player-name">{{ player_name }}</h1>
                <span class="room-badge">Room: {{ room_code }}</span>
            </div>
            <div class="player-money">
                <span class="money-label">Cash:</span>
                <span class="money-amount" id="player-money">$6,000</span>
            </div>
        </header>

        <main class="player-main">
            <section class="tile-rack-section">
                <h2>Your Tiles</h2>
                <div class="tile-rack" id="tile-rack">
                    <button class="tile" id="tile-0" data-tile="" disabled>-</button>
                    <button class="tile" id="tile-1" data-tile="" disabled>-</button>
                    <button class="tile" id="tile-2" data-tile="" disabled>-</button>
                    <button class="tile" id="tile-3" data-tile="" disabled>-</button>
                    <button class="tile" id="tile-4" data-tile="" disabled>-</button>
                    <button class="tile" id="tile-5" data-tile="" disabled>-</button>
                </div>
            </section>

            <section class="portfolio-section">
                <h2>Stock Portfolio</h2>
                <table class="portfolio-table" id="portfolio-table">
                    <thead>
                        <tr>
                            <th>Chain</th>
                            <th>Shares</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="portfolio-row" data-chain="luxor">
                            <td><span class="chain-dot chain-luxor"></span> Luxor</td>
                            <td class="shares" id="shares-luxor">0</td>
                            <td class="value" id="value-luxor">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="tower">
                            <td><span class="chain-dot chain-tower"></span> Tower</td>
                            <td class="shares" id="shares-tower">0</td>
                            <td class="value" id="value-tower">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="american">
                            <td><span class="chain-dot chain-american"></span> American</td>
                            <td class="shares" id="shares-american">0</td>
                            <td class="value" id="value-american">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="festival">
                            <td><span class="chain-dot chain-festival"></span> Festival</td>
                            <td class="shares" id="shares-festival">0</td>
                            <td class="value" id="value-festival">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="worldwide">
                            <td><span class="chain-dot chain-worldwide"></span> Worldwide</td>
                            <td class="shares" id="shares-worldwide">0</td>
                            <td class="value" id="value-worldwide">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="continental">
                            <td><span class="chain-dot chain-continental"></span> Continental</td>
                            <td class="shares" id="shares-continental">0</td>
                            <td class="value" id="value-continental">$0</td>
                        </tr>
                        <tr class="portfolio-row" data-chain="imperial">
                            <td><span class="chain-dot chain-imperial"></span> Imperial</td>
                            <td class="shares" id="shares-imperial">0</td>
                            <td class="value" id="value-imperial">$0</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="action-section" id="action-section">
                <h2>Actions</h2>
                <div class="action-buttons" id="action-buttons">
                    <p class="waiting-message" id="waiting-message">Waiting for your turn...</p>
                </div>
            </section>

            <section class="buy-stocks-section hidden" id="buy-stocks-section">
                <h2>Buy Stocks</h2>
                <p class="buy-instruction">Select up to 3 stocks to purchase:</p>
                <div class="buy-options" id="buy-options">
                    <div class="buy-option" data-chain="luxor">
                        <span class="chain-dot chain-luxor"></span>
                        <span class="chain-name">Luxor</span>
                        <span class="stock-price" id="price-luxor">$200</span>
                        <span class="stock-available" id="available-luxor">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="luxor">-</button>
                            <span class="qty-value" id="qty-luxor">0</span>
                            <button class="qty-btn qty-plus" data-chain="luxor">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="tower">
                        <span class="chain-dot chain-tower"></span>
                        <span class="chain-name">Tower</span>
                        <span class="stock-price" id="price-tower">$200</span>
                        <span class="stock-available" id="available-tower">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="tower">-</button>
                            <span class="qty-value" id="qty-tower">0</span>
                            <button class="qty-btn qty-plus" data-chain="tower">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="american">
                        <span class="chain-dot chain-american"></span>
                        <span class="chain-name">American</span>
                        <span class="stock-price" id="price-american">$300</span>
                        <span class="stock-available" id="available-american">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="american">-</button>
                            <span class="qty-value" id="qty-american">0</span>
                            <button class="qty-btn qty-plus" data-chain="american">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="festival">
                        <span class="chain-dot chain-festival"></span>
                        <span class="chain-name">Festival</span>
                        <span class="stock-price" id="price-festival">$300</span>
                        <span class="stock-available" id="available-festival">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="festival">-</button>
                            <span class="qty-value" id="qty-festival">0</span>
                            <button class="qty-btn qty-plus" data-chain="festival">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="worldwide">
                        <span class="chain-dot chain-worldwide"></span>
                        <span class="chain-name">Worldwide</span>
                        <span class="stock-price" id="price-worldwide">$300</span>
                        <span class="stock-available" id="available-worldwide">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="worldwide">-</button>
                            <span class="qty-value" id="qty-worldwide">0</span>
                            <button class="qty-btn qty-plus" data-chain="worldwide">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="continental">
                        <span class="chain-dot chain-continental"></span>
                        <span class="chain-name">Continental</span>
                        <span class="stock-price" id="price-continental">$400</span>
                        <span class="stock-available" id="available-continental">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="continental">-</button>
                            <span class="qty-value" id="qty-continental">0</span>
                            <button class="qty-btn qty-plus" data-chain="continental">+</button>
                        </div>
                    </div>
                    <div class="buy-option" data-chain="imperial">
                        <span class="chain-dot chain-imperial"></span>
                        <span class="chain-name">Imperial</span>
                        <span class="stock-price" id="price-imperial">$400</span>
                        <span class="stock-available" id="available-imperial">25 left</span>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" data-chain="imperial">-</button>
                            <span class="qty-value" id="qty-imperial">0</span>
                            <button class="qty-btn qty-plus" data-chain="imperial">+</button>
                        </div>
                    </div>
                </div>
                <div class="buy-summary">
                    <span class="total-label">Total:</span>
                    <span class="total-amount" id="buy-total">$0</span>
                    <span class="stocks-selected" id="stocks-selected">(0/3 stocks)</span>
                </div>
                <div class="buy-actions">
                    <button class="btn btn-secondary" id="cancel-buy">Cancel</button>
                    <button class="btn btn-primary" id="confirm-buy">Confirm Purchase</button>
                </div>
            </section>

            <section class="merger-section hidden" id="merger-section">
                <h2>Merger Decision</h2>
                <div class="merger-info">
                    <p class="merger-description" id="merger-description">
                        <span class="defunct-chain" id="defunct-chain">Chain</span> is being acquired by
                        <span class="surviving-chain" id="surviving-chain">Chain</span>
                    </p>
                    <p class="your-shares">You have <span id="merger-shares">0</span> shares of <span id="merger-chain-name">Chain</span></p>
                </div>
                <div class="merger-options">
                    <div class="merger-option">
                        <h3>Sell</h3>
                        <p class="option-description">Sell shares for cash</p>
                        <p class="option-value" id="sell-value">$0 per share</p>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" id="sell-minus">-</button>
                            <span class="qty-value" id="sell-qty">0</span>
                            <button class="qty-btn qty-plus" id="sell-plus">+</button>
                        </div>
                    </div>
                    <div class="merger-option">
                        <h3>Trade</h3>
                        <p class="option-description">Trade 2:1 for surviving chain</p>
                        <p class="option-value" id="trade-info">2 shares = 1 share</p>
                        <div class="quantity-controls">
                            <button class="qty-btn qty-minus" id="trade-minus">-</button>
                            <span class="qty-value" id="trade-qty">0</span>
                            <button class="qty-btn qty-plus" id="trade-plus">+</button>
                        </div>
                    </div>
                    <div class="merger-option">
                        <h3>Keep</h3>
                        <p class="option-description">Hold shares for later</p>
                        <p class="option-value">Remaining shares</p>
                        <div class="keep-display">
                            <span class="qty-value" id="keep-qty">0</span>
                        </div>
                    </div>
                </div>
                <div class="merger-actions">
                    <button class="btn btn-primary" id="confirm-merger">Confirm Decision</button>
                </div>
            </section>

            <section class="choose-chain-section hidden" id="choose-chain-section">
                <h2>Choose a Chain</h2>
                <p class="choose-instruction" id="choose-instruction">Select a hotel chain to found:</p>
                <div class="chain-choices" id="chain-choices">
                    <!-- Chain choice buttons will be added dynamically -->
                </div>
            </section>
        </main>

        <footer class="player-footer">
            <div class="game-status" id="game-status">
                <span class="status-indicator"></span>
                <span class="status-text">Connected</span>
            </div>
        </footer>
    </div>

    <script>
        // Pass Jinja2 variables to JavaScript
        window.PLAYER_DATA = {
            roomCode: "{{ room_code }}",
            playerId: "{{ player_id }}",
            playerName: "{{ player_name }}",
            sessionToken: "{{ session_token }}"
        };
    </script>
    <script type="module" src="/static/js/player/index.js"></script>
</body>
</html>
